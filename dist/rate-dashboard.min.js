!function(){"use strict";angular.module("rateApp.rate-dashboard",["xeditable","rateApp.rate-services"])}(),function(){"use strict";function e(){function e(){return[{name:"Luke Skywalker",reviews:1},{name:"R2-D2",reviews:2},{name:"Darth Vader",reviews:3},{name:"Han Solo",reviews:4},{name:"Leia Amidala",reviews:5},{name:"Yoda",reviews:6}]}var r=this;r.data=r.data||e()}angular.module("rateApp.rate-dashboard").controller("RateBarChartController",e)}(),function(){"use strict";function e(e,r,t,a,n,l){function o(){function o(){return t.getPeople().then(function(e){return c.people=e,c.people&&0!==c.people.length?c.people:n.getData(l.assets.ASSETS_DATA+"/personajes.json").then(function(e){return c.people=e,c.people})})}function s(){return a.getReviews().then(function(e){return c.reviews=e,c.reviews&&0!==c.reviews.length?c.reviews:n.getData(l.assets.ASSETS_DATA+"/valoraciones.json").then(function(e){return c.reviews=e,c.reviews})})}e.$emit("startLoading","RateDashboardController");var d=[o(),s()];return r.all(d).then(function(){i(),e.$emit("endLoading","RateDashboardController")})}function s(){function r(e,r){e&&e[0]&&e[1]&&(e[0]===r[0]&&e[1]===r[1]||(c.people=c.people!==e[0]?e[0]:c.people,c.reviews=c.reviews!==e[1]?e[1]:c.reviews,i()))}function t(e,r){r!==e&&(c.people=e,i())}function a(e,r){r!==e&&(c.reviews=e,i())}e.$watch("rateDashboardCtrl.people",t,!0),e.$watch("rateDashboardCtrl.reviews",a,!0),e.$watchGroup(["rateDashboardCtrl.people","rateDashboardCtrl.reviews"],r,!0)}function i(){function e(){if(c.reviews&&0!==c.reviews.length){for(var e,r={star0:0,star1:0,star2:0,star3:0,star4:0,star5:0},t=0;t<c.reviews.length;t++)e=c.reviews[t],r["star"+e.stars]++;return r}}function r(){for(var e={},r=0;r<c.people.length;r++)e[c.people[r]._id]={name:c.people[r].nick,reviews:0};for(var t=0;t<c.reviews.length;t++)e[c.reviews[t].personId]&&e[c.reviews[t].personId].reviews++;return e}function t(){for(var e,r=[],t=0;t<c.people.length;t++)e=c.people[t],r.push({value:e._id,text:e.nick});return r}c.stars=e(),c.reviewsByPerson=r(),c.peopleOptions=t(),c.panels=d()}function d(){return[{value:" ",className:"fa-dashboard",title:"Dashboard",color:"yellow",mensaje:"Mostrar detalle",url:"#/dashboard/resume"},{value:c.people?c.people.length:0,className:"fa-users",title:"Personajes",color:"primary",mensaje:"Mostrar detalle",url:"#/dashboard/people"},{value:c.reviews?c.reviews.length:0,className:"fa-star",title:"Valoraciones",color:"green",mensaje:"Mostrar detalle",url:"#/dashboard/reviews"}]}var c=this;c.people=[],c.reviews=[],c.stars={},c.reviewsByPerson={},c.peopleOptions=[],s(),o()}angular.module("rateApp.rate-dashboard").controller("RateDashboardController",e),e.$inject=["$scope","$q","PeopleService","ReviewService","DataService","RateAssets"]}(),function(){"use strict";function e(){function e(){return[{name:"Luke Skywalker",reviews:1},{name:"R2-D2",reviews:2},{name:"Darth Vader",reviews:3},{name:"Han Solo",reviews:4},{name:"Leia Amidala",reviews:5},{name:"Yoda",reviews:6}]}var r=this;r.data=r.data||e()}angular.module("rateApp.rate-dashboard").controller("RateDonutChartController",e)}(),function(){"use strict";function e(e){function r(e,r){e.value!==r.value&&(a.elem.value=e.value)}function t(){return{value:"0",className:"fa-question",title:"title",color:"green",mensaje:"Mostrar",url:"#/resume"}}var a=this;a.elem=a.elem||t(),e.$watch("ratePanelCtrl.elem",r,!0)}angular.module("rateApp.rate-dashboard").controller("RatePanelController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e){function r(r){var t=n.people[r]._id;n.people.splice(r,1),t&&e.deletePerson(t)}function t(){n.inserted={nick:"",job:null,profileImg:null,background:","},n.people.push(n.inserted)}function a(r,t){t?e.updatePerson(t,r):e.addPerson(r).then(function(e){n.inserted._id=e._id})}var n=this;n.title=n.title||"Title",n.people=n.people||[],n.addPerson=t,n.removePerson=r,n.savePerson=a}angular.module("rateApp.rate-dashboard").controller("RateTablePeopleController",e),e.$inject=["PeopleService"]}(),function(){"use strict";function e(e,r){function t(e){var t=s.reviews[e]._id;s.reviews.splice(e,1),t&&r.deleteReview(t)}function a(){s.inserted={stars:0,description:"",personId:"",createDate:null},s.reviews.push(s.inserted)}function n(e,t){t?r.updateReview(t,e):(e.createDate=Date.now(),r.addReview(e).then(function(e){s.inserted._id=e._id}))}function l(){return[{value:"57504e7223bf601425000038",text:"Luke Skywalker"},{value:"575050c823bf601425000039",text:"R2-D2"},{value:"5750521f23bf60142500003a",text:"Darth Vader"},{value:"575052ee23bf60142500003b",text:"Han Solo"},{value:"575053cf23bf60142500003c",text:"Leia Amidala"},{value:"5750547b23bf60142500003d",text:"Yoda"}]}function o(r){var t=[];return r&&(t=e("filter")(s.peopleOptions,{value:r})),t.length?t[0].text:"Not set"}var s=this;s.title=s.title||"Title",s.reviews=s.reviews||[],s.peopleOptions=s.peopleOptions||l(),s.showPerson=o,s.addReview=a,s.removeReview=t,s.saveReview=n}angular.module("rateApp.rate-dashboard").controller("RateTableReviewController",e),e.$inject=["$filter","ReviewService"]}(),function(){"use strict";function e(){return{restrict:"A",templateUrl:"src/rate-dashboard/template/rate-bar-chart.template.html",link:r,controller:"RateBarChartController",controllerAs:"RateBarChartCtrl",scope:{data:"="}}}function r(e,r){function t(e,r){e&&e!==r&&n.barChart&&n.barChart.setData(a())}function a(){var r,t=[];if(e.data){var a=e.data;for(var n in a)r={},r[l]=a[n].name,r[o]=a[n].reviews,t.push(r)}return t}var n=this,l="per",o="val";n.barChart=Morris.Bar({element:$("#morris-bar-chart",r),data:a(),xkey:l,ykeys:[o],labels:["Valoraciones"],barColors:["#f0ad4e"],xLabelAngle:35,hideHover:"auto"}),e.$watch("data",t,!0)}angular.module("rateApp.rate-dashboard").directive("rateBarChart",e),r.$inject=["$scope","$element"]}(),function(){"use strict";function e(){return{restrict:"E",templateUrl:"src/rate-dashboard/template/rate-dashboard.template.html",controller:"RateDashboardController",controllerAs:"rateDashboardCtrl"}}angular.module("rateApp.rate-dashboard").directive("rateDashboard",e)}(),function(){"use strict";function e(){return{restrict:"A",templateUrl:"src/rate-dashboard/template/rate-donut-chart.template.html",link:r,controller:"RateDonutChartController",controllerAs:"RateDonutChartCtrl",scope:{data:"="}}}function r(e,r){function t(e,r){e&&e!==r&&n.donutChart&&n.donutChart.setData(a())}function a(){function r(r){if(!e.data)return t();var a=e.data;return void 0!==a[r]?a[r]:t()}function t(){return Math.round(10*Math.random())}return[{label:"☆☆☆☆☆",value:r("star0")},{label:"★☆☆☆☆",value:r("star1")},{label:"★★☆☆☆",value:r("star2")},{label:"★★★☆☆",value:r("star3")},{label:"★★★★☆",value:r("star4")},{label:"★★★★★",value:r("star5")}]}var n=this;n.donutChart=Morris.Donut({element:$("#morris-donut-chart",r),data:a()}),e.$watch("data",t,!0)}angular.module("rateApp.rate-dashboard").directive("rateDonutChart",e),r.$inject=["$scope","$element"]}(),function(){"use strict";function e(){return{restrict:"A",templateUrl:"src/rate-dashboard/template/rate-panel.template.html",controller:"RatePanelController",controllerAs:"ratePanelCtrl",scope:{elem:"="},bindToController:!0}}angular.module("rateApp.rate-dashboard").directive("ratePanel",e)}(),function(){"use strict";function e(){return{restrict:"A",templateUrl:"src/rate-dashboard/template/rate-table-people.template.html",controller:"RateTablePeopleController",controllerAs:"rateTablePeopleCtrl",scope:{title:"@",people:"="},bindToController:!0}}angular.module("rateApp.rate-dashboard").directive("rateTablePeople",e)}(),function(){"use strict";function e(){return{restrict:"A",templateUrl:"src/rate-dashboard/template/rate-table-review.template.html",controller:"RateTableReviewController",controllerAs:"rateTableReviewCtrl",scope:{title:"@",reviews:"=",peopleOptions:"="},bindToController:!0}}angular.module("rateApp.rate-dashboard").directive("rateTableReview",e)}(),function(){"use strict";angular.module("rateApp.rate-dashboard").run(["$templateCache",function(e){e.put("src/rate-dashboard/template/rate-bar-chart.template.html",'<div class="panel-heading">\r\n    <i class="fa fa-bar-chart-o fa-fw"></i> Valoraciones por personaje\r\n</div>\r\n<div class="panel-body">\r\n    <div class="row">\r\n        <div class="col-lg-12">\r\n            <div id="morris-bar-chart"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'),e.put("src/rate-dashboard/template/rate-dashboard.template.html",'<style>\r\n#page-wrapper {\r\n    margin-top: 50px;\r\n}\r\n</style>\r\n<div id="page-wrapper" class="container">\r\n    <div class="row">\r\n        <div class="col-lg-12">\r\n            <h1 class="page-header">Dashboard</h1>\r\n        </div>\r\n    </div>\r\n    <div class="row">\r\n        <div class="col-md-2">\r\n            <ul class="nav in" id="side-menu">\r\n                <li>\r\n                    <a ui-sref=".resume" class="active"><i class="fa fa-dashboard fa-fw"></i> Dashboard</a>\r\n                </li>\r\n                <li>\r\n                    <a ui-sref=".people"><i class="fa fa-users fa-fw"></i> Personajes</a>\r\n                </li>\r\n                <li>\r\n                    <a ui-sref=".reviews"><i class="fa fa-star fa-fw"></i> Valoraciones</a>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <div class="col-md-10">\r\n            <div class="row">\r\n                <div class="col-md-4" rate-panel elem="element" ng-repeat="element in rateDashboardCtrl.panels">\r\n                </div>\r\n            </div>\r\n            <div ui-view></div>\r\n            <!--div ng-if="rateDashboardCtrl.showPeople" class="row animate-if" rate-table-people people="rateDashboardCtrl.people" title="Personajes">\r\n            </div>\r\n            <div ng-if="rateDashboardCtrl.showReviews" class="row animate-if" rate-table-review reviews="rateDashboardCtrl.reviews" title="Valoraciones" people-options="rateDashboardCtrl.peopleOptions">\r\n            </div>\r\n            <div class="row">\r\n                <div class="col-lg-8">\r\n                    <div class="panel panel-default" rate-bar-chart data="rateDashboardCtrl.reviewsByPerson"></div>\r\n                </div>\r\n                <div class="col-lg-4">\r\n                    <div class="panel panel-default" rate-donut-chart data="rateDashboardCtrl.stars">\r\n                    </div>\r\n                </div>\r\n            </div-->\r\n        </div>\r\n    </div>\r\n</div>\r\n'),e.put("src/rate-dashboard/template/rate-donut-chart.template.html",'<div class="panel-heading">\r\n    <i class="fa fa-bar-chart-o fa-fw"></i> Cantidad de valoraciones por estrella\r\n</div>\r\n<div class="panel-body">\r\n    <div id="morris-donut-chart"></div>\r\n</div>\r\n'),e.put("src/rate-dashboard/template/rate-panel.template.html",'<style>\r\n.panel-green {\r\n    border-color: #5cb85c;\r\n}\r\n\r\n.panel-yellow {\r\n    border-color: #f0ad4e;\r\n}\r\n\r\n.panel-green .panel-heading {\r\n    border-color: #5cb85c;\r\n    color: #fff;\r\n    background-color: #5cb85c;\r\n}\r\n\r\n.panel-yellow .panel-heading {\r\n    border-color: #f0ad4e;\r\n    color: #fff;\r\n    background-color: #f0ad4e;\r\n}\r\n\r\n.panel-green a {\r\n    color: #5cb85c;\r\n}\r\n\r\n.panel-yellow a {\r\n    color: #f0ad4e;\r\n}\r\n\r\n.huge {\r\n    font-size: 40px;\r\n}\r\n</style>\r\n<div class="panel panel-{{ratePanelCtrl.elem.color}}">\r\n    <div class="panel-heading">\r\n        <div class="row">\r\n            <div class="col-xs-3">\r\n                <i class="fa {{ratePanelCtrl.elem.className}} fa-5x"></i>\r\n            </div>\r\n            <div class="col-xs-9 text-right">\r\n                <div class="huge">{{ratePanelCtrl.elem.value}}</div>\r\n                <div>{{ratePanelCtrl.elem.title}}</div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <a ng-href="{{ratePanelCtrl.elem.url}}">\r\n        <div class="panel-footer">\r\n            <span class="pull-left">{{ratePanelCtrl.elem.mensaje}}</span>\r\n            <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>\r\n            <div class="clearfix"></div>\r\n        </div>\r\n    </a>\r\n</div>\r\n'),e.put("src/rate-dashboard/template/rate-table-people.template.html",'<div class="col-lg-12">\r\n    <div class="panel panel-default">\r\n        <div class="panel-heading">\r\n            <i class="fa fa-bar-chart-o fa-fw"></i> {{rateTablePeopleCtrl.title}}\r\n        </div>\r\n        <div class="panel-body inboxpanel-body">\r\n            <div class="table-responsive">\r\n                <table class="table table-bordered table-hover table-condensed">\r\n                    <tr style="font-weight: bold">\r\n                        <td>Name</td>\r\n                        <td>Description</td>\r\n                        <td>Profile Image</td>\r\n                        <td>Background</td>\r\n                        <td>Options</td>\r\n                    </tr>\r\n                    <tr ng-repeat="person in rateTablePeopleCtrl.people">\r\n                        <td>\r\n                            <!-- editable name (text without validation) -->\r\n                            <span editable-text="person.nick" e-name="nick" e-form="rowform" e-required>\r\n                              {{ person.nick || \'empty\' }}\r\n                            </span>\r\n                        </td>\r\n                        <td>\r\n                            <!-- editable description (text without validation) -->\r\n                            <span editable-textarea="person.job" e-rows="7" e-cols="30" e-name="job" e-form="rowform" e-required>\r\n                              {{ person.job || \'empty\' }}\r\n                            </span>\r\n                        </td>\r\n                        <td>\r\n                            <!-- editable profileImg (text without validation) -->\r\n                            <span editable-textarea="person.profileImg" e-rows="7" e-cols="30" e-name="profileImg" e-form="rowform" e-required>\r\n                              <img ng-show="!rowform.$visible" ng-src="{{ person.profileImg || \'empty\' }}"/>\r\n                            </span>\r\n                        </td>\r\n                        <td ng-style="{\'background\': !rowform.$visible ? person.background : \'\', \'background-size\': \'cover\'}">\r\n                            <span editable-textarea="person.background" e-rows="7" e-cols="30" e-name="background" e-form="rowform" e-required>\r\n                            </span>\r\n                        </td>\r\n                        <td style="white-space: nowrap">\r\n                            <!-- form -->\r\n                            <form editable-form name="rowform" onbeforesave="rateTablePeopleCtrl.savePerson($data, person._id)" ng-show="rowform.$visible" class="form-buttons form-inline" shown="rateTablePeopleCtrl.inserted == person">\r\n                                <button type="submit" ng-disabled="rowform.$waiting" class="btn btn-primary">\r\n                                    save\r\n                                </button>\r\n                                <button type="button" ng-disabled="rowform.$waiting" ng-click="rowform.$cancel()" class="btn btn-default">\r\n                                    cancel\r\n                                </button>\r\n                            </form>\r\n                            <div class="buttons" ng-hide="rowform.$visible">\r\n                                <button class="btn btn-primary" ng-click="rowform.$show()">edit</button>\r\n                                <button class="btn btn-danger" ng-click="rateTablePeopleCtrl.removePerson($index)">del</button>\r\n                            </div>\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n                <button class="btn btn-default" ng-click="rateTablePeopleCtrl.addPerson()">Add row</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'),e.put("src/rate-dashboard/template/rate-table-review.template.html",'<div class="col-lg-12">\r\n    <div class="panel panel-default">\r\n        <div class="panel-heading">\r\n            <i class="fa fa-bar-chart-o fa-fw"></i> {{rateTableReviewCtrl.title}}\r\n        </div>\r\n        <div class="panel-body inboxpanel-body">\r\n            <div class="table-responsive">\r\n                <table class="table table-bordered table-hover table-condensed">\r\n                    <tr style="font-weight: bold">\r\n                        <td>Stars</td>\r\n                        <td>Description</td>\r\n                        <td>Person</td>\r\n                        <td>Options</td>\r\n                    </tr>\r\n                    <tr ng-repeat="review in rateTableReviewCtrl.reviews">\r\n                        <td>\r\n                            <!-- editable name (text without validation) -->\r\n                            <span editable-range="review.stars" e-name="stars" e-form="rowform" e-required e-step="1" e-min="0" e-max="5">\r\n                              {{ review.stars || \'empty\' }}\r\n                            </span>\r\n                        </td>\r\n                        <td>\r\n                            <!-- editable description (text without validation) -->\r\n                            <span editable-textarea="review.description" e-rows="7" e-cols="30" e-name="description" e-form="rowform" e-required>\r\n                              {{ review.description || \'empty\' }}\r\n                            </span>\r\n                        </td>\r\n                        <td>\r\n                            <!-- editable status (select-local) -->\r\n                            <span editable-select="review.personId" e-name="personId" e-form="rowform" e-ng-options="pOption.value as pOption.text for pOption in rateTableReviewCtrl.peopleOptions">\r\n                              {{ rateTableReviewCtrl.showPerson(review.personId) }}\r\n                            </span>\r\n                        </td>\r\n                        <td style="white-space: nowrap">\r\n                            <!-- form -->\r\n                            <form editable-form name="rowform" onbeforesave="rateTableReviewCtrl.saveReview($data, review._id)" ng-show="rowform.$visible" class="form-buttons form-inline" shown="rateTableReviewCtrl.inserted == review">\r\n                                <button type="submit" ng-disabled="rowform.$waiting" class="btn btn-primary">\r\n                                    save\r\n                                </button>\r\n                                <button type="button" ng-disabled="rowform.$waiting" ng-click="rowform.$cancel()" class="btn btn-default">\r\n                                    cancel\r\n                                </button>\r\n                            </form>\r\n                            <div class="buttons" ng-hide="rowform.$visible">\r\n                                <button class="btn btn-primary" ng-click="rowform.$show()">edit</button>\r\n                                <button class="btn btn-danger" ng-click="rateTableReviewCtrl.removeReview($index)">del</button>\r\n                            </div>\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n                <button class="btn btn-default" ng-click="rateTableReviewCtrl.addReview()">Add row</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n')}])}();