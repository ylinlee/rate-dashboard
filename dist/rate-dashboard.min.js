!function(){"use strict";angular.module("rateApp.rate-dashboard",["xeditable","rateApp.rate-services"])}(),function(){"use strict";function e(){function e(){return[{name:"Luke Skywalker",reviews:1},{name:"R2-D2",reviews:2},{name:"Darth Vader",reviews:3},{name:"Han Solo",reviews:4},{name:"Leia Amidala",reviews:5},{name:"Yoda",reviews:6}]}var t=this;t.data=t.data||e()}angular.module("rateApp.rate-dashboard").controller("RateBarChartController",e)}(),function(){"use strict";function e(e,t,a,r,l,o){function n(){function n(){return a.getPeople().then(function(e){return c.people=e,c.people&&0!==c.people.length?c.people:l.getData(o.assets.ASSETS_DATA+"/personajes.json").then(function(e){return c.people=e,c.people})})}function s(){return r.getReviews().then(function(e){return c.reviews=e,c.reviews&&0!==c.reviews.length?c.reviews:l.getData(o.assets.ASSETS_DATA+"/valoraciones.json").then(function(e){return c.reviews=e,c.reviews})})}e.$emit("startLoading","RateDashboardController");var d=[n(),s()];return t.all(d).then(function(){i(),e.$emit("endLoading","RateDashboardController")})}function s(){function t(e,t){e&&e[0]&&e[1]&&(e[0]===t[0]&&e[1]===t[1]||(c.people=c.people!==e[0]?e[0]:c.people,c.reviews=c.reviews!==e[1]?e[1]:c.reviews,i()))}function a(e,t){t!==e&&(c.people=e,i())}function r(e,t){t!==e&&(c.reviews=e,i())}e.$watch("rateDashboardCtrl.people",a,!0),e.$watch("rateDashboardCtrl.reviews",r,!0),e.$watchGroup(["rateDashboardCtrl.people","rateDashboardCtrl.reviews"],t,!0)}function i(){function e(){if(c.reviews&&0!==c.reviews.length){for(var e,t={star0:0,star1:0,star2:0,star3:0,star4:0,star5:0},a=0;a<c.reviews.length;a++)e=c.reviews[a],t["star"+e.stars]++;return t}}function t(){for(var e={},t=0;t<c.people.length;t++)e[c.people[t]._id]={name:c.people[t].nick,reviews:0};for(var a=0;a<c.reviews.length;a++)e[c.reviews[a].personId]&&e[c.reviews[a].personId].reviews++;return e}function a(){for(var e,t=[],a=0;a<c.people.length;a++)e=c.people[a],t.push({value:e._id,text:e.nick});return t}c.stars=e(),c.reviewsByPerson=t(),c.peopleOptions=a(),c.panels=d()}function d(){return[{value:" ",className:"fa-dashboard",title:"Dashboard",color:"yellow",mensaje:"Mostrar detalle",url:"#/dashboard/resume"},{value:c.people?c.people.length:0,className:"fa-users",title:"Personajes",color:"primary",mensaje:"Mostrar detalle",url:"#/dashboard/people"},{value:c.reviews?c.reviews.length:0,className:"fa-star",title:"Valoraciones",color:"green",mensaje:"Mostrar detalle",url:"#/dashboard/reviews"}]}var c=this;c.people=[],c.reviews=[],c.stars={},c.reviewsByPerson={},c.peopleOptions=[],s(),n()}angular.module("rateApp.rate-dashboard").controller("RateDashboardController",e),e.$inject=["$scope","$q","PeopleService","ReviewService","DataService","RateAssets"]}(),function(){"use strict";function e(){function e(){return[{name:"Luke Skywalker",reviews:1},{name:"R2-D2",reviews:2},{name:"Darth Vader",reviews:3},{name:"Han Solo",reviews:4},{name:"Leia Amidala",reviews:5},{name:"Yoda",reviews:6}]}var t=this;t.data=t.data||e()}angular.module("rateApp.rate-dashboard").controller("RateDonutChartController",e)}(),function(){"use strict";function e(e){function t(e,t){e.value!==t.value&&(r.elem.value=e.value)}function a(){return{value:"0",className:"fa-question",title:"title",color:"green",mensaje:"Mostrar",url:"#/resume"}}var r=this;r.elem=r.elem||a(),e.$watch("ratePanelCtrl.elem",t,!0)}angular.module("rateApp.rate-dashboard").controller("RatePanelController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e){function t(t){var a=l.people[t]._id;l.people.splice(t,1),a&&e.deletePerson(a)}function a(){l.inserted={nick:"",job:null,profileImg:null,background:","},l.people.push(l.inserted)}function r(t,a){a?e.updatePerson(a,t):e.addPerson(t).then(function(e){l.inserted._id=e._id})}var l=this;l.title=l.title||"Title",l.people=l.people||[],l.addPerson=a,l.removePerson=t,l.savePerson=r}angular.module("rateApp.rate-dashboard").controller("RateTablePeopleController",e),e.$inject=["PeopleService"]}(),function(){"use strict";function e(e,t){function a(e){var a=s.reviews[e]._id;s.reviews.splice(e,1),a&&t.deleteReview(a)}function r(){s.inserted={stars:0,description:"",personId:"",createDate:null},s.reviews.push(s.inserted)}function l(e,a){a?t.updateReview(a,e):(e.createDate=Date.now(),t.addReview(e).then(function(e){s.inserted._id=e._id}))}function o(){return[{value:"57504e7223bf601425000038",text:"Luke Skywalker"},{value:"575050c823bf601425000039",text:"R2-D2"},{value:"5750521f23bf60142500003a",text:"Darth Vader"},{value:"575052ee23bf60142500003b",text:"Han Solo"},{value:"575053cf23bf60142500003c",text:"Leia Amidala"},{value:"5750547b23bf60142500003d",text:"Yoda"}]}function n(t){var a=[];return t&&(a=e("filter")(s.peopleOptions,{value:t})),a.length?a[0].text:"Not set"}var s=this;s.title=s.title||"Title",s.reviews=s.reviews||[],s.peopleOptions=s.peopleOptions||o(),s.showPerson=n,s.addReview=r,s.removeReview=a,s.saveReview=l}angular.module("rateApp.rate-dashboard").controller("RateTableReviewController",e),e.$inject=["$filter","ReviewService"]}(),function(){"use strict";function e(){return{restrict:"A",templateUrl:"src/rate-dashboard/template/rate-bar-chart.template.html",link:t,controller:"RateBarChartController",controllerAs:"RateBarChartCtrl",scope:{data:"="}}}function t(e,t){function a(e,t){e&&e!==t&&l.barChart&&l.barChart.setData(r())}function r(){var t,a=[];if(e.data){var r=e.data;for(var l in r)t={},t[o]=r[l].name,t[n]=r[l].reviews,a.push(t)}return a}var l=this,o="per",n="val";l.barChart=Morris.Bar({element:$("#morris-bar-chart",t),data:r(),xkey:o,ykeys:[n],labels:["Valoraciones"],barColors:["#f0ad4e"],xLabelAngle:35,hideHover:"auto"}),e.$watch("data",a,!0)}angular.module("rateApp.rate-dashboard").directive("rateBarChart",e),t.$inject=["$scope","$element"]}(),function(){"use strict";function e(){return{restrict:"E",templateUrl:"src/rate-dashboard/template/rate-dashboard.template.html",controller:"RateDashboardController",controllerAs:"rateDashboardCtrl"}}angular.module("rateApp.rate-dashboard").directive("rateDashboard",e)}(),function(){"use strict";function e(){return{restrict:"A",templateUrl:"src/rate-dashboard/template/rate-donut-chart.template.html",link:t,controller:"RateDonutChartController",controllerAs:"RateDonutChartCtrl",scope:{data:"="}}}function t(e,t){function a(e,t){e&&e!==t&&l.donutChart&&l.donutChart.setData(r())}function r(){function t(t){if(!e.data)return a();var r=e.data;return void 0!==r[t]?r[t]:a()}function a(){return Math.round(10*Math.random())}return[{label:"☆☆☆☆☆",value:t("star0")},{label:"★☆☆☆☆",value:t("star1")},{label:"★★☆☆☆",value:t("star2")},{label:"★★★☆☆",value:t("star3")},{label:"★★★★☆",value:t("star4")},{label:"★★★★★",value:t("star5")}]}var l=this;l.donutChart=Morris.Donut({element:$("#morris-donut-chart",t),data:r()}),e.$watch("data",a,!0)}angular.module("rateApp.rate-dashboard").directive("rateDonutChart",e),t.$inject=["$scope","$element"]}(),function(){"use strict";function e(){return{restrict:"A",templateUrl:"src/rate-dashboard/template/rate-panel.template.html",controller:"RatePanelController",controllerAs:"ratePanelCtrl",scope:{elem:"="},bindToController:!0}}angular.module("rateApp.rate-dashboard").directive("ratePanel",e)}(),function(){"use strict";function e(){return{restrict:"A",templateUrl:"src/rate-dashboard/template/rate-table-people.template.html",controller:"RateTablePeopleController",controllerAs:"rateTablePeopleCtrl",scope:{title:"@",people:"="},bindToController:!0}}angular.module("rateApp.rate-dashboard").directive("rateTablePeople",e)}(),function(){"use strict";function e(){return{restrict:"A",templateUrl:"src/rate-dashboard/template/rate-table-review.template.html",controller:"RateTableReviewController",controllerAs:"rateTableReviewCtrl",scope:{title:"@",reviews:"=",peopleOptions:"="},bindToController:!0}}angular.module("rateApp.rate-dashboard").directive("rateTableReview",e)}(),function(){"use strict";angular.module("rateApp.rate-dashboard").run(["$templateCache",function(e){e.put("src/rate-dashboard/template/rate-bar-chart.template.html",'<div class="panel-heading"><i class="fa fa-bar-chart-o fa-fw"></i> Valoraciones por personaje</div><div class="panel-body"><div class="row"><div class="col-lg-12"><div id="morris-bar-chart"></div></div></div></div>'),e.put("src/rate-dashboard/template/rate-dashboard.template.html",'<style>#page-wrapper {\r\n    margin-top: 50px;\r\n}</style><div id="page-wrapper" class="container"><div class="row"><div class="col-lg-12"><h1 class="page-header">Dashboard</h1></div></div><div class="row"><div class="col-md-2"><ul class="nav in" id="side-menu"><li><a ui-sref=".resume" class="active"><i class="fa fa-dashboard fa-fw"></i> Dashboard</a></li><li><a ui-sref=".people"><i class="fa fa-users fa-fw"></i> Personajes</a></li><li><a ui-sref=".reviews"><i class="fa fa-star fa-fw"></i> Valoraciones</a></li></ul></div><div class="col-md-10"><div class="row"><div class="col-md-4" rate-panel elem="element" ng-repeat="element in rateDashboardCtrl.panels"></div></div><div ui-view></div><!--div ng-if="rateDashboardCtrl.showPeople" class="row animate-if" rate-table-people people="rateDashboardCtrl.people" title="Personajes">\r\n            </div>\r\n            <div ng-if="rateDashboardCtrl.showReviews" class="row animate-if" rate-table-review reviews="rateDashboardCtrl.reviews" title="Valoraciones" people-options="rateDashboardCtrl.peopleOptions">\r\n            </div>\r\n            <div class="row">\r\n                <div class="col-lg-8">\r\n                    <div class="panel panel-default" rate-bar-chart data="rateDashboardCtrl.reviewsByPerson"></div>\r\n                </div>\r\n                <div class="col-lg-4">\r\n                    <div class="panel panel-default" rate-donut-chart data="rateDashboardCtrl.stars">\r\n                    </div>\r\n                </div>\r\n            </div--></div></div></div>'),e.put("src/rate-dashboard/template/rate-donut-chart.template.html",'<div class="panel-heading"><i class="fa fa-bar-chart-o fa-fw"></i> Cantidad de valoraciones por estrella</div><div class="panel-body"><div id="morris-donut-chart"></div></div>'),e.put("src/rate-dashboard/template/rate-panel.template.html",'<style>.panel-green {\r\n    border-color: #5cb85c;\r\n}\r\n\r\n.panel-yellow {\r\n    border-color: #f0ad4e;\r\n}\r\n\r\n.panel-green .panel-heading {\r\n    border-color: #5cb85c;\r\n    color: #fff;\r\n    background-color: #5cb85c;\r\n}\r\n\r\n.panel-yellow .panel-heading {\r\n    border-color: #f0ad4e;\r\n    color: #fff;\r\n    background-color: #f0ad4e;\r\n}\r\n\r\n.panel-green a {\r\n    color: #5cb85c;\r\n}\r\n\r\n.panel-yellow a {\r\n    color: #f0ad4e;\r\n}\r\n\r\n.huge {\r\n    font-size: 40px;\r\n}</style><div class="panel panel-{{ratePanelCtrl.elem.color}}"><div class="panel-heading"><div class="row"><div class="col-xs-3"><i class="fa {{ratePanelCtrl.elem.className}} fa-5x"></i></div><div class="col-xs-9 text-right"><div class="huge">{{ratePanelCtrl.elem.value}}</div><div>{{ratePanelCtrl.elem.title}}</div></div></div></div><a ng-href="{{ratePanelCtrl.elem.url}}"><div class="panel-footer"><span class="pull-left">{{ratePanelCtrl.elem.mensaje}}</span> <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span><div class="clearfix"></div></div></a></div>'),e.put("src/rate-dashboard/template/rate-table-people.template.html",'<div class="col-lg-12"><div class="panel panel-default"><div class="panel-heading"><i class="fa fa-bar-chart-o fa-fw"></i> {{rateTablePeopleCtrl.title}}</div><div class="panel-body inboxpanel-body"><div class="table-responsive"><table class="table table-bordered table-hover table-condensed"><tr style="font-weight: bold"><td>Name</td><td>Description</td><td>Profile Image</td><td>Background</td><td>Options</td></tr><tr ng-repeat="person in rateTablePeopleCtrl.people"><td><!-- editable name (text without validation) --> <span editable-text="person.nick" e-name="nick" e-form="rowform" e-required>{{ person.nick || \'empty\' }}</span></td><td><!-- editable description (text without validation) --> <span editable-textarea="person.job" e-rows="7" e-cols="30" e-name="job" e-form="rowform" e-required>{{ person.job || \'empty\' }}</span></td><td><!-- editable profileImg (text without validation) --> <span editable-textarea="person.profileImg" e-rows="7" e-cols="30" e-name="profileImg" e-form="rowform" e-required><img ng-show="!rowform.$visible" ng-src="{{ person.profileImg || \'empty\' }}"></span></td><td ng-style="{\'background\': !rowform.$visible ? person.background : \'\', \'background-size\': \'cover\'}"><span editable-textarea="person.background" e-rows="7" e-cols="30" e-name="background" e-form="rowform" e-required></span></td><td style="white-space: nowrap"><!-- form --><form editable-form name="rowform" onbeforesave="rateTablePeopleCtrl.savePerson($data, person._id)" ng-show="rowform.$visible" class="form-buttons form-inline" shown="rateTablePeopleCtrl.inserted == person"><button type="submit" ng-disabled="rowform.$waiting" class="btn btn-primary">save</button> <button type="button" ng-disabled="rowform.$waiting" ng-click="rowform.$cancel()" class="btn btn-default">cancel</button></form><div class="buttons" ng-hide="rowform.$visible"><button class="btn btn-primary" ng-click="rowform.$show()">edit</button> <button class="btn btn-danger" ng-click="rateTablePeopleCtrl.removePerson($index)">del</button></div></td></tr></table><button class="btn btn-default" ng-click="rateTablePeopleCtrl.addPerson()">Add row</button></div></div></div></div>'),e.put("src/rate-dashboard/template/rate-table-review.template.html",'<div class="col-lg-12"><div class="panel panel-default"><div class="panel-heading"><i class="fa fa-bar-chart-o fa-fw"></i> {{rateTableReviewCtrl.title}}</div><div class="panel-body inboxpanel-body"><div class="table-responsive"><table class="table table-bordered table-hover table-condensed"><tr style="font-weight: bold"><td>Stars</td><td>Description</td><td>Person</td><td>Options</td></tr><tr ng-repeat="review in rateTableReviewCtrl.reviews"><td><!-- editable name (text without validation) --> <span editable-range="review.stars" e-name="stars" e-form="rowform" e-required e-step="1" e-min="0" e-max="5">{{ review.stars || \'empty\' }}</span></td><td><!-- editable description (text without validation) --> <span editable-textarea="review.description" e-rows="7" e-cols="30" e-name="description" e-form="rowform" e-required>{{ review.description || \'empty\' }}</span></td><td><!-- editable status (select-local) --> <span editable-select="review.personId" e-name="personId" e-form="rowform" e-ng-options="pOption.value as pOption.text for pOption in rateTableReviewCtrl.peopleOptions">{{ rateTableReviewCtrl.showPerson(review.personId) }}</span></td><td style="white-space: nowrap"><!-- form --><form editable-form name="rowform" onbeforesave="rateTableReviewCtrl.saveReview($data, review._id)" ng-show="rowform.$visible" class="form-buttons form-inline" shown="rateTableReviewCtrl.inserted == review"><button type="submit" ng-disabled="rowform.$waiting" class="btn btn-primary">save</button> <button type="button" ng-disabled="rowform.$waiting" ng-click="rowform.$cancel()" class="btn btn-default">cancel</button></form><div class="buttons" ng-hide="rowform.$visible"><button class="btn btn-primary" ng-click="rowform.$show()">edit</button> <button class="btn btn-danger" ng-click="rateTableReviewCtrl.removeReview($index)">del</button></div></td></tr></table><button class="btn btn-default" ng-click="rateTableReviewCtrl.addReview()">Add row</button></div></div></div></div>')}])}();